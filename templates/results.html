{# Accepts: header dependicies, results, id, fi #}


{% extends "root.html" %}

{% block title %}Результаты проверки{% endblock %}

{% block main %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
    <style>
    .hiddenRow {
     padding: 0 !important;
     }
    </style>

    <div class="header row">{% include "header.html" %}</div>
    <div class="holder row" id="results_holder">
      <table class="dataframe" id="stats_table" width="100%">
        <thead>
          <tr style="text-align: left;">
            <tr>
              {% for item in columns %}
              <th>{{ item }} </th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><a class="id_check" href="{{ "/results/"  ~ stats[0]}}">
                {{ (stats[0] | string)[-5:]}}</a></td>
                <td>{{ stats[1] }}</td>
                <td>{{ stats[2] }}</td>
                <td>{{ stats[3] }}</td>
                <td>{{ stats[4] }}</td>
              </tr>
            </tbody>
        <h3 id="results_title" class="texteous ins">Результат проверки: {{ "" if results.correct() else "не" }} пройдена!</h3>
        <table class="table table-striped table-hover" id="results_table">
            <thead>
                <tr>
                    <th></th>
                    <th class="results_table_index ins" scope="col">#</th>
                    <th class="results_table_test ins" scope="col">Тест</th>
                    <th class="results_table_result ins" scope="col">Результат</th>
                </tr>
            </thead>
            <tbody>
                <tr data-toggle="collapse" data-target="#verd1" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">1</th>
                    <td class="ins">Количество основных слайдов(до запасных слайдов)</td>
                    <td class="{{ "table-secondary ins" if results.slides_number == -1 else ("table-success ins" if results.slides_number.pass else "table-danger ins") }}">
                       {{ "Не проведена" if results.slides_number == -1 else ("Пройдена" if results.slides_number.pass else "Не пройдена") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd1" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.slides_number == -1 %}
                        {{ 'Не проведена' }}
                    {% else %}
                        {% for item in results.slides_number.get('verdict', ["Пройдена!"] if results.slides_number.pass else ["Не пройдена"]) %}
                            {{ item }}<br>
                        {% endfor %}
                    {% endif %}
                </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd2" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">2</th>
                    <td class="ins">Нумерация слайдов</td>
                    <td class="{{ "table-secondary ins" if results.slides_enum == -1 else ("table-success ins" if results.slides_enum.pass else "table-danger ins") }}">
                      {{ "Не проведена" if results.slides_enum == -1 else ("Пройдена!" if results.slides_enum.pass else "Не пройдена") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd2" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.slides_enum == -1 %}
                        {{ "Не проведена" }}
                    {% else %}
                        {% for item in results.slides_enum.get('verdict', ["Пройдена!"] if results.slides_enum.pass else ["Не пройдена"]) %}
                            {{ item }}<br>
                        {% endfor %}
                    {% endif %}
               </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd3" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">3</th>
                    <td class="ins">Заголовки слайдов присутствуют и занимают не более двух строк</td>
                    <td class="{{ "table-secondary ins" if results.slides_headers == -1 else ("table-success ins" if results.slides_headers.pass else "table-danger ins") }}">
                    {{ "Не проведена" if results.slides_headers == -1 else ("Пройдена!" if results.slides_headers.pass else "Не пройдена") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd3" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.slides_headers == -1 %}
                        {{ "Не проведена" }}
                    {% else %}
                        {% for item in results.slides_headers.get('verdict', ["Пройдена!"] if results.slides_headers.pass else ["Не пройдена"]) %}
                            {{ item }}<br>
                        {% endfor %}
                    {% endif %}
                </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd4" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">4</th>
                    <td class="ins">Слайд "Цель и задачи"</td>
                    <td class="{{ "table-secondary ins" if results.goals_slide == -1 else ("table-success ins" if results.goals_slide.pass else "table-danger ins") }}">
                    {{ "Не проведена" if results.goals_slide == -1 else ("Найден" if results.goals_slide.pass else "Не найден") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd4" class="accordian-body collapse" style="margin-left: 2em;">
                     {% if results.goals_slide == -1 %}
                         {{ "Не проведена" }}
                     {% else %}
                         {% for item in results.goals_slide.get('verdict', ["Найден"] if results.goals_slide.pass else ["Не найден!"]) %}
                              {{ item }}<br>
                         {% endfor %}
                     {% endif %}
                </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd5" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">5</th>
                    <td class="ins">Слайд "Апробация работы"</td>
                    <td class="{{ "table-secondary ins" if results.probe_slide == -1 else ("table-success ins" if results.probe_slide.pass else "table-danger ins") }}">
                    {{ "Не проведена" if results.probe_slide == -1 else ("Найден" if results.probe_slide.pass else "Не найден") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd5" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.probe_slide == -1 %}
                        {{ "Не проведена" }}
                    {% else %}
                        {% for item in results.probe_slide.get('verdict', ["Найден"] if results.probe_slide.pass else ["Не найден!"]) %}
                            {{ item }}<br>
                        {% endfor %}
                    {% endif %}
                </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd6" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">6</th>
                    <td class="ins">Слайд с описанием актуальности работы</td>
                    <td class="{{ "table-secondary ins" if results.actual_slide == -1 else ("table-success ins" if results.actual_slide.pass else "table-danger ins") }}">
                    {{ "Не проведена" if results.actual_slide == -1 else ("Найден" if results.actual_slide.pass else "Не найден") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd6" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.actual_slide == -1 %}
                        {{ "Не проведена" }}
                    {% else %}
                        {% for item in results.actual_slide.get('verdict', ["Найден"] if results.actual_slide.pass else ["Не найден!"]) %}
                            {{ item }}<br>
                        {% endfor %}
                    {% endif %}
                </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd7" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">7</th>
                    <td class="ins">Слайд с заключением</td>
                    <td class="{{ "table-secondary ins" if results.conclusion_slide == -1 else ("table-success ins" if results.conclusion_slide.pass else "table-danger ins") }}">
                    {{ "Не проведена" if results.conclusion_slide == -1 else ("Найден" if results.conclusion_slide.pass else "Не найден") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd7" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.conclusion_slide == -1 %}
                        {{ "Не проведена" }}
                    {% else %}
                        {% for item in results.conclusion_slide.get('verdict', ["Найден"] if results.conclusion_slide.pass else ["Не найден!"]) %}
                            {{ item }}<br>
                        {% endfor %}
                    {% endif %}
                </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd8" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">8</th>
                    <td class="ins">Наличие слайдов, посвященных задачам</td>
                    <td class="{{ "table-secondary ins" if results.slide_every_task == -1 else ("table-success ins" if results.slide_every_task.pass else "table-danger ins") }}">
                    {{ "Не проведена" if results.slide_every_task == -1 else ("Пройдена!" if results.slide_every_task.pass else "Не пройдена") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd8" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.slide_every_task == -1 %}
                        {{ "Не проведена" }}
                    {% else %}
                        {% for item in results.slide_every_task.get('verdict', ["Пройдена!"] if results.slide_every_task.pass else ["Не пройдена"]) %}
                            {% if item.startswith('Распознанные задачи') or item.startswith('Все задачи найдены на') or item.startswith('Всего задач:') or item.startswith('Не найдены:') %}
                                {{ item }}<br>
                            {% else %}
                                 <div style="margin-left: 2em;">{{ item }}<br></div>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd9" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">9</th>
                    <td class="ins">Соответствие заключения задачам</td>
                    <td class="{{ "table-secondary ins" if results.conclusion_actual == -1 else ("table-success ins" if results.conclusion_actual.pass else "table-danger ins") }}">
                         {{ "Не проведена" if results.conclusion_actual == -1 else ("Соответствует на " ~ results.conclusion_actual.value ~ "%") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd9" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.conclusion_actual == -1 %}
                        {{ "Не проведена" }}
                    {% else %}
                        {% for item in results.conclusion_actual.get('verdict', ["Пройдена!"] if results.conclusion_actual.pass else ["Не пройдена"]) %}
                            {% if item.startswith('Распознанные заключения') or item.startswith('Соответствует на') %}
                                {{ item }}<br>
                            {% else %}
                                <div style="margin-left: 2em;">{{ item }}<br></div>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </div></td></tr>
                <tr data-toggle="collapse" data-target="#verd10" class="accordion-toggle">
                    <td><button class="btn btn-default btn-xs"><i class="bi bi-chevron-double-down"></i></button></td>
                    <th scope="row" class="ins">10</th>
                    <td class="ins">Наличие направлений дальнейшего развития</td>
                    <td class="{{ "table-secondary ins" if results.conclusion_along == -1 else ("table-success ins" if results.conclusion_along.pass else "table-danger ins") }}">
                        {{ "Не проведена" if results.conclusion_along == -1 else ("Найдены" if results.conclusion_along.pass else "Не найдены") }}
                    </td>
                </tr>
                <tr><td colspan="4" class="hiddenRow"><div id="verd10" class="accordian-body collapse" style="margin-left: 2em;">
                    {% if results.conclusion_along == -1 %}
                        {{ "Не проведена" }}
                    {% else %}
                        {% for item in results.conclusion_along.get('verdict', ["Пройдена!"] if results.conclusion_along.pass else ["Не пройдена"]) %}
                            {{ item }}<br>
                        {% endfor %}
                    {% endif %}
                </div></td></tr>
            </tbody>
        </table>
        <a href="/checks/{{ id }}" id="presentation_download" class="col text-center" download="{{ fi }}">Скачать презентацию</a>
    </div>
    <div class="footer row"></div>
{% endblock %}
